  MODULE VOIGT_MOD_RK
    USE SET_RK, ONLY: RK
    IMPLICIT NONE

    PRIVATE
    PUBLIC :: HUMLIK, VOIGT_RK


  CONTAINS

    ! ============================================
    ! ============================================
    ! *****************************************************************
    ! *****************************************************************
    SUBROUTINE VOIGT_RK(N1, N2, X, Y, V)
      ! ----------
      ! VOIGT_RK IS A FORTRAN SUBROUTINE TO CALCULATE THE VOIGT FUNCTION. THE SUBROUTINE 
      ! TAKES THE FOLLOWING INPUTS:
      ! - A REAL SCALAR Y AND A VECTOR OF SCALARS X  
      ! IT RETURNS AS OUTPUT THE VOIGT FUNCTION V.
      ! ----------
      ! THE ROUTINE DIVIDES THE COMPUTATIONAL DOMAIN INTO A SET OF REGIONS DEPENDING
      ! ON THE VALUES OF X AND Y WHERE IT APPROXIMATES THE FUNCTION FOR REGIONS WITH
      ! X**2+Y**2>25 IN TERMS OF LAPLACE CONTINUED FRACTIONS WHILE FOR THE INNER REGION(S)
      ! THE FUNCTION IS APPROXIMATED IN TERMS OF A SET OF BIVARIATE POLYNOMIAL EXPRESSION
      ! DERIVED USING CHEBYSHEV SUBINTERVAL POLYNOMIA APPROXIMATION IN 2-D. A FEW TERMS
      ! OF TAYLOR SERIES TOGETHER WITH SIMPLE APPROXIMATIONS OF DAWSON INTEGRAL ARE
      ! USED TO EVALUATE THE FUNCTION NEAR THE X-AXIS IN THE REGION
      ! 7.39<=(X**2+Y**2)<=110.0
      ! THE SUBROUTINE EVALUATES THE VOIGT FUNCTION TO ACCURACY OF THE ORDER OF 10^-6.
      ! ------------
      ! ------------
      ! THE ROUTINE CAN BE RUN IN SINGLE PRECISION OR IN DOUBLE PRECISION
      ! DEPENDING ON THE CHOICE OF THE INTEGER PARAMETER RK IN THE
      ! SUBSIDIARY MODULE SET_RK
      ! -------------
      ! THE ACCOMPANYING DRIVER CODE “VOIGT_DRIVER.F90” CAN BE RUN FOR
      ! COMPARISON WITH THE HUMLIK SUBROUTINE AND IT GENERATES EXAMPLES FOR 
      ! INPUT DATA USED FOR COMPARISON.
      ! ----------
      ! COPYRIGHT (C) [2024]
      ! AUTHOR: MOFREH R. ZAGHLOUL
      ! UNITED ARAB EMIRATES UNIVERSITY, OCTOBER 24, 2024
      ! ALL RIGHTS RESERVED.
      ! SOFTWARE NAME: VOIGT_RK
      ! VERSION: 1
      ! THIS SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
      ! INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
      ! PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHOR OR COPYRIGHT HOLDER BE LIABLE
      ! FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
      ! OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
      ! OTHER DEALINGS IN THE SOFTWARE.

      ! REDISTRIBUTION AND USE IN SOURCE AND BINARY FORMS, WITH OR WITHOUT MODIFICATION, ARE
      ! PERMITTED PROVIDED THAT THE FOLLOWING CONDITIONS ARE MET:
      ! 1. REDISTRIBUTIONS OF SOURCE CODE MUST RETAIN THE ABOVE COPYRIGHT NOTICE, THIS LIST OF
      ! CONDITIONS AND THE FOLLOWING DISCLAIMER.
      ! 2. REDISTRIBUTIONS IN BINARY FORM MUST REPRODUCE THE ABOVE COPYRIGHT NOTICE, THIS LIST OF
      ! CONDITIONS AND THE FOLLOWING DISCLAIMER IN THE DOCUMENTATION AND/OR OTHER MATERIALS
      ! PROVIDED WITH THE DISTRIBUTION.
      ! 3. THIS SOFTWARE CANNOT BE USED FOR COMMERCIAL PURPOSES WITHOUT SPECIFIC PRIOR WRITTEN
      ! PERMISSION.
      ! 4. PROPER CITATION TO THE ORIGINAL PAPER MUST BE MADE IN ANY PUBLICATIONS OR 
      ! PRODUCTS USING THIS SOFTWARE: ZAGHLOUL, M. R., LE BOURLOT,J.,
      ! “A HIGHLY EFFICIENT VOIGT PROGRAM FOR LINE PROFILE COMPUTATION,"
      ! In Press, JQSRT (2024)
      ! ----------
      ! ----------


      INTEGER, INTENT (IN) :: N1, N2
      REAL (RK), INTENT (IN) :: X(N1:N2)
      REAL (RK), INTENT (IN) :: Y
      REAL (RK), INTENT (OUT) :: V(N1:N2)
     
      Real (rk), Parameter :: quarter = 0.25E0_rk
      Real (rk), Parameter :: half = 0.5E0_rk
      Real (rk), Parameter :: one = 1.0E0_rk
      Real (rk), Parameter :: three_halfs = 1.5E0_rk
      Real (rk), Parameter :: two = 2.0E0_rk
      Real (rk), Parameter :: three = 3.0E0_rk
      Real (rk), Parameter :: four = 4.0E0_rk
      Real (rk), Parameter :: one_sqrt_pi = 0.5641895835477562869480794_rk ! 1/SQRT(PI
    
      REAL (RK) :: ABS_X, X_SQR, Y_SQR, XSQR_PLUS_YSQR, YSQR_MINUS_XSQR_3HALFS, FOUR_X_SQR_Y_SQR, &
        THREE_YSQR, FOUR_YSQR, SIX_YSQR, TT, TT2, Y1, Y2, YSQR_MINUS_XSQR, DW, D_1, ALFA, Y_RTP
      REAL (RK) TWO_SQRT_PI_Y
     
      INTEGER I

      Y_SQR = Y*Y
      Y_RTP = Y*ONE_SQRT_PI
      THREE_YSQR = THREE*Y_SQR
      FOUR_YSQR = FOUR*Y_SQR
      SIX_YSQR = 6.0_RK*Y_SQR
      TT2 = 1.8125_RK/(Y+1.8125_RK)
      TWO_SQRT_PI_Y = TWO*Y_RTP

     
      DO I = N1, N2
        ABS_X = ABS(X(I))
        X_SQR = ABS_X*ABS_X

        ! -------------REGION I ----> LAPLACE CONT. FRACTIONS, 1 CONVERGENT
         IF ((X_SQR+Y_SQR)>=1.6E5_RK) THEN
          ! :-  W=((J1* ONE_SQRT_PI)/Z)
          V(I) = Y_RTP/(X_SQR+Y_SQR) 

          ! -------------REGION II ----> LAPLACE CONT. FRACTIONS, 2 CONVERGENTS
           ELSE IF ((X_SQR+Y_SQR)>=510.0_RK) THEN
          ! :-  W=(J1*ONE_SQRT_PI*Z)/(Z*Z-0.5_RK)
          XSQR_PLUS_YSQR = X_SQR + Y_SQR
          V(I) = (HALF+XSQR_PLUS_YSQR)*(Y_RTP/((XSQR_PLUS_YSQR*XSQR_PLUS_YSQR+ &
            (Y_SQR-X_SQR))+QUARTER))

          ! -------------REGION III ----> LAPLACE CONT. FRACTIONS, 3 CONVERGENTS
        ELSE IF ((X_SQR+Y_SQR)>=110.0_RK) THEN
          ! :-  W=(J1*ONE_SQRT_PI/Z)*(Z**2-1.0_RK)/(Z**2-1.5_RK)
          YSQR_MINUS_XSQR_3HALFS = Y_SQR - X_SQR + THREE_HALFS
          FOUR_X_SQR_Y_SQR = FOUR*X_SQR*Y_SQR

          V(I) = ((Y_RTP*((YSQR_MINUS_XSQR_3HALFS-HALF)*(YSQR_MINUS_XSQR_3HALFS)+FOUR_X_SQR_Y_SQR+ &
            X_SQR)))/((X_SQR+Y_SQR)*((YSQR_MINUS_XSQR_3HALFS)*(YSQR_MINUS_XSQR_3HALFS)+ &
            FOUR_X_SQR_Y_SQR))

        ELSE IF ((X_SQR+Y_SQR)>=40.0_RK) THEN
          ! :- W= ONE_SQRT_PI*(J1*Z)*(Z**2-2.5)/(Z**2*(Z**2-3)+0.75)
          IF (Y<=1E-10_RK) THEN
            YSQR_MINUS_XSQR = Y_SQR - X_SQR
            ! DW = DAWSON_RK(ABS_X)
            ALFA = HALF/X_SQR
            DW = (ABS_X*ALFA)*(ONE+ALFA*(ONE+ALFA*(THREE+ALFA*(15.0_RK+ALFA*(105.0_RK+ALFA*(945.0_RK &
              +ALFA*(10395.0_RK+ALFA*(135135.0_RK))))))))

            D_1 = (ONE-TWO*ABS_X*DW)
            V(I) = EXP(-X_SQR) - TWO_SQRT_PI_Y*D_1

          ELSE
            ! THREE_YSQR = THREE*Y_SQR
            ! FOUR_YSQR = FOUR*Y_SQR
            V(I) = Y_RTP*((1.88_RK+(8.25_RK+(5.50_RK+Y_SQR)*Y_SQR)*Y_SQR+(5.25_RK+ &
              (ONE+THREE_YSQR)*Y_SQR+(-4.50_RK+THREE_YSQR+X_SQR)*X_SQR)*X_SQR)/((0.5625_RK+ &
              (4.50_RK+(10.50_RK+(6.00_RK+Y_SQR)*Y_SQR)*Y_SQR)*Y_SQR+ &
              (-4.50_RK+(9.00_RK+(6.00_RK+FOUR_YSQR)*Y_SQR)*Y_SQR+(10.50_RK+(-6.00_RK+6.00_RK* &
              Y_SQR)*Y_SQR+(-6.00_RK+FOUR_YSQR+X_SQR)*X_SQR)*X_SQR)*X_SQR)))

          END IF

        ELSE IF ((X_SQR+Y_SQR)>=38.0_RK) THEN
          IF (Y<=1E-8_RK) THEN

            ALFA = ONE/X_SQR
            DW = (HALF/ABS_X)*(ONE+ALFA*(HALF+ALFA*(0.75_RK+ALFA*(1.875_RK+ALFA*(6.5625_RK+ALFA*( &
              29.53125_RK+ALFA*(162.421875_RK+ALFA*(1055.7421875_RK))))))))

            V(I) = EXP(-X_SQR) - (TWO_SQRT_PI_Y)*(ONE-TWO*ABS_X*DW)

          ELSE
            ! :- W= ONE_SQRT_PI*(J1*Z)*(Z**2-2.5)/(Z**2*(Z**2-3)+0.75)
            V(I) = Y_RTP*((1.88_RK+(8.25_RK+(5.50_RK+Y_SQR)*Y_SQR)*Y_SQR+(5.25_RK+ &
              (ONE+THREE_YSQR)*Y_SQR+(-4.50_RK+THREE_YSQR+X_SQR)*X_SQR)*X_SQR)/((0.5625_RK+ &
              (4.50_RK+(10.50_RK+(6.00_RK+Y_SQR)*Y_SQR)*Y_SQR)*Y_SQR+ &
              (-4.50_RK+(9.00_RK+(6.00_RK+FOUR_YSQR)*Y_SQR)*Y_SQR+(10.50_RK+(-6.00_RK+6.00_RK* &
              Y_SQR)*Y_SQR+(-6.00_RK+FOUR_YSQR+X_SQR)*X_SQR)*X_SQR)*X_SQR)))

          END IF

        ELSE IF ((X_SQR+Y_SQR)>=25.0_RK) THEN
          IF (Y<=1E-3_RK) THEN
            YSQR_MINUS_XSQR = Y_SQR - X_SQR
            ALFA = ONE/X_SQR
            DW = (HALF/ABS_X)*(ONE+ALFA*(HALF+ALFA*(0.75_RK+ALFA*(1.875_RK+ALFA*(6.5625_RK+ALFA*( &
              29.53125_RK+ALFA*(162.421875_RK+ALFA*(1055.7421875_RK+ALFA*7918.06640625_RK))))))))

            D_1 = (ONE-TWO*ABS_X*DW)
            V(I) = EXP(YSQR_MINUS_XSQR)*(COS(TWO*ABS_X*Y)) - (TWO_SQRT_PI_Y)*(D_1-Y_SQR*( &
              -(0.666666666666666667_RK)*(ABS_X*(-(ABS_X*D_1+DW))+D_1)))

          ELSE
            ! :- W= ONE_SQRT_PI*(J1/Z)*(Z**2*(Z**2-4.5)+2.0)/(Z**2*(Z**2-5)+3.75)

            V(I) = Y_RTP*((7.50_RK+(26.88_RK+(28.25_RK+(9.50_RK+Y_SQR)*Y_SQR)*Y_SQR)*Y_SQR+( &
              -13.12_RK+(17.50_RK+(10.50_RK+FOUR_YSQR)*Y_SQR)*Y_SQR+ &
              (21.25_RK+(-7.50_RK+SIX_YSQR)*Y_SQR+(-8.50_RK+FOUR_YSQR+X_SQR)*X_SQR)* &
              X_SQR)*X_SQR)/((14.06_RK+(37.50_RK+(32.50_RK+(10.00_RK+Y_SQR)*Y_SQR)*Y_SQR)*Y_SQR+ &
              (-37.50_RK+(5.00_RK+(10.00_RK+FOUR_YSQR)*Y_SQR)*Y_SQR+(32.50_RK+(-10.00_RK+ &
              SIX_YSQR)*Y_SQR+(-10.00_RK+FOUR_YSQR+X_SQR)*X_SQR)*X_SQR)*X_SQR)*((X_SQR+Y_SQR))))


          END IF
        ELSE

          TT = 1.8125_RK/(ABS_X+1.8125_RK)
 
          IF (TT>=0.9_RK .AND. TT2>=0.5_RK) THEN
            Y1 = 20.0_RK*TT - 19.0_RK
            Y2 = 4.0_RK*TT2 - 3.0_RK
            V(I) = .5632498726_RK + (.3542230461_RK+(0.7152538189E-1_RK+(0.3002625767E-2_RK+ &
              (-0.1041429147E-2_RK-0.1909418979E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.5664171440E-2_RK+(0.8108604158E-2_RK+(0.4333650014E-2_RK+ &
              (0.9126855322E-3_RK+(-0.1083868453E-4_RK-0.2366963363E-4_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.3244565065E-2_RK+(-0.4624838526E-2_RK+ &
              (-0.2453756192E-2_RK+(-0.5082311152E-3_RK+(0.8455499919E-5_RK+0.1324081469E-4_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2+(0.2893933006E-3_RK+(0.3912679393E-3_RK+(0.1884041895E-3_RK+( &
              0.2987970227E-4_RK+(-0.3118815529E-5_RK-8.404586797E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (-0.9952791848E-5_RK+(-0.5308987855E-5_RK+(0.5132582495E-5_RK+ &
              (0.4802200261E-5_RK+(9.725449051E-7_RK-1.054598930E-7_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-7.115609430E-7_RK+(-0.2367007547E-5_RK+ &
              (-0.2432806037E-5_RK+(-0.1033924836E-5_RK+(-1.224061703E-7_RK+2.691927683E-8_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.9_RK .AND. TT2>=0.15_RK) THEN
            Y1 = 20.0_RK*TT - 19.0_RK
            Y2 = 5.714285714285714_RK*TT2 - 1.857142857142857_RK

            V(I) = 0.1449857394_RK + (0.1085411385_RK+(0.2056964907E-1_RK+(0.2420326459E-2_RK+ &
              (0.4370321992E-4_RK-0.3235322410E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.1681804553E-3_RK+(0.3583124919E-3_RK+(0.3041544206E-3_RK+ &
              (0.1300463881E-3_RK+(0.2722796731E-4_RK+0.1488384762E-5_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.9719035476E-4_RK+(-0.2068461972E-3_RK+ &
              (-0.1752260323E-3_RK+(-0.7459385043E-4_RK+(-0.1542892934E-4_RK-7.820429294E-7_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2+(0.9579459231E-5_RK+(0.2015357232E-4_RK+(0.1669436735E-4_RK+( &
              0.6758905576E-5_RK+(0.1196755901E-5_RK-5.346371593E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (-6.837083469E-7_RK+(-0.1354599098E-5_RK+(-9.853370526E-7_RK+ &
              (-2.711330927E-7_RK+(2.882907979E-8_RK+2.903135414E-8_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(3.975534048E-8_RK+(6.800597871E-8_RK+(3.097521792E-8_RK+( &
              -1.079705661E-8_RK+(-1.554272000E-8_RK-4.976968601E-9_RK*Y2)*Y2)*Y2)* &
              Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.8_RK .AND. TT2>=0.5_RK) THEN
            Y1 = 20.0_RK*TT - 17.0_RK
            Y2 = 4.0_RK*TT2 - 3.0_RK

            V(I) = 0.5364988737_RK + (0.3163829824_RK+(0.5170826257E-1_RK+(-0.9809010404E-3_RK+ &
              (-0.9414398441E-3_RK+0.8522130811E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.2235109991E-1_RK+(0.3122782941E-1_RK+(0.1600698534E-1_RK+ &
              (0.3054364449E-2_RK+(-0.1231293980E-3_RK-0.8061761993E-4_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.5125931487E-2_RK+(-0.6830516778E-2_RK+ &
              (-0.3204448958E-2_RK+(-0.4709035063E-3_RK+(0.6030990246E-4_RK+0.1277637971E-4_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2+(0.3121702078E-3_RK+(0.2784733808E-3_RK+(0.4051142863E-5_RK+( &
              -0.6312776656E-4_RK+(-0.1553056902E-4_RK+0.1705582246E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (0.9999187332E-5_RK+(0.4490160203E-4_RK+(0.4866901802E-4_RK+ &
              (0.2004827819E-4_RK+(0.1812988961E-5_RK-6.488298229E-7_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.3716046625E-5_RK+(-0.8284827528E-5_RK+ &
              (-0.6383516080E-5_RK+(-0.1811899252E-5_RK+(5.718097164E-8_RK+8.759454048E-8_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.8_RK .AND. TT2>=0.15_RK) THEN
            Y1 = 20.0_RK*TT - 17.0_RK
            Y2 = 5.714285714285714_RK*TT2 - 1.857142857142857_RK

            V(I) = 0.1441716835_RK + (0.1068119641_RK+(0.1911020468E-1_RK+(0.1803958173E-2_RK+ &
              (-0.8098725653E-4_RK-0.3776997199E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.6972564283E-3_RK+(0.1476622565E-2_RK+(0.1239104751E-2_RK+ &
              (0.5167558435E-3_RK+(0.1007969830E-3_RK+0.3149507838E-5_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.1746833248E-3_RK+(-0.3661221972E-3_RK+ &
              (-0.3010714065E-3_RK+(-0.1199373956E-3_RK+(-0.2018246120E-4_RK+4.520732337E-7_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2+(0.1695596546E-4_RK+(0.3399082879E-4_RK+(0.2544013523E-4_RK+( &
              0.7825199171E-5_RK+(-3.190738972E-8_RK-5.157606493E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (-0.1215075010E-5_RK+(-0.2134395514E-5_RK+(-0.1093540848E-5_RK+ &
              (1.560035382E-7_RK+(3.532452993E-7_RK+1.113027109E-7_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(6.821313228E-8_RK+(8.259320790E-8_RK+(-2.693309441E-8_RK+( &
              -9.107591361E-8_RK+(-5.473892356E-8_RK-1.144724495E-8_RK*Y2)*Y2)*Y2)* &
              Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.7_RK .AND. TT2>=0.5_RK) THEN
            Y1 = 20.0_RK*TT - 15.0_RK
            Y2 = 4.0_RK*TT2 - 3.0_RK

            V(I) = 0.4690911110_RK + (0.2253868434_RK+(0.7836049364E-2_RK+(-0.8093790591E-2_RK+ &
              (-0.3054568396E-3_RK+0.2705430410E-3_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.4592567761E-1_RK+(0.5970340295E-1_RK+(0.2677674801E-1_RK+ &
              (0.3410793964E-2_RK+(-0.5935882877E-3_RK-0.8287413164E-4_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.6380140942E-2_RK+(-0.6639312714E-2_RK+ &
              (-0.1515383359E-2_RK+(0.5066593881E-3_RK+(0.1768183895E-3_RK-0.2079569154E-4_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2+(0.2389667408E-4_RK+(-0.4964614703E-3_RK+(-0.6575252938E-3_RK+( &
              -0.2706651750E-3_RK+(-0.1535424672E-4_RK+0.1077874770E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (0.7117135236E-4_RK+(0.1570479885E-3_RK+(0.1108883902E-3_RK+ &
              (0.2277364690E-4_RK+(-0.4614279454E-5_RK-0.1479458969E-5_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.8325238532E-5_RK+(-0.1214208500E-4_RK+ &
              (-0.2902766962E-5_RK+(0.3072932879E-5_RK+(0.1484539579E-5_RK- &
              3.400748411E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1


          ELSE IF (TT>=0.7_RK .AND. TT2>=0.15_RK) THEN
            Y1 = 20.0_RK*TT - 15.0_RK
            Y2 = 5.714285714285714_RK*TT2 - 1.857142857142857_RK

            V(I) = 0.1419210480_RK + (0.1020856003_RK+(0.1520812709E-1_RK+(0.2340974929E-3_RK+ &
              (-0.3554407691E-3_RK-0.3598087621E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.1644207537E-2_RK+(0.3423564597E-2_RK+(0.2779455958E-2_RK+ &
              (0.1076031960E-2_RK+(0.1647250439E-3_RK-0.9341212553E-5_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.3116041637E-3_RK+(-0.6273526084E-3_RK+ &
              (-0.4747967831E-3_RK+(-0.1528337129E-3_RK+(-0.6100046908E-5_RK+0.7141692155E-5_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2+(0.2981173301E-4_RK+(0.5387389658E-4_RK+(0.3073339452E-4_RK+( &
              6.082647867E-7_RK+(-0.5799489993E-5_RK-0.1846897894E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (-0.2055703346E-5_RK+(-0.2663985522E-5_RK+(3.199952983E-7_RK+ &
              (0.2121363412E-5_RK+(0.1197988005E-5_RK+1.944322246E-7_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2+(9.711063848E-8_RK+(-1.115519945E-8_RK+(-3.187634487E-7_RK+( &
              -3.390695127E-7_RK+(-1.094618428E-7_RK+4.098828297E-9_RK*Y2)*Y2)*Y2)* &
              Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.6_RK .AND. TT2>=0.5_RK) THEN
            Y1 = 20.0_RK*TT - 13.0_RK
            Y2 = 4.0_RK*TT2 - 3.0_RK
            V(I) = .3529389090_RK + (0.8625233787E-1_RK+(-0.4478914651E-1_RK+(-0.1050791318E-1_RK+ &
              (0.1731368944E-2_RK+(0.2472562449E-3_RK-0.9792733002E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.6878388977E-1_RK+(0.7447123465E-1_RK+(0.2148589250E-1_RK+ &
              (-0.2171047006E-2_RK+(-0.1255212980E-2_RK+(0.1644177764E-3_RK+0.3798106435E-4_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.4153891733E-2_RK+(0.8183919404E-3_RK+ &
              (0.4887141779E-2_RK+(0.2184780393E-2_RK+(-0.1321985365E-5_RK+ &
              (-0.1063460433E-3_RK+0.9825428452E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.8626566650E-3_RK+ &
              (-0.2014236087E-2_RK+(-0.1315580752E-2_RK+(-0.1469401175E-3_RK+ &
              (0.1068230488E-3_RK+(0.1170436086E-4_RK-0.7014759008E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (0.1383835679E-3_RK+(0.1642714331E-3_RK+(-0.1700432090E-4_RK+ &
              (-0.8221224359E-4_RK+(-0.2436507670E-4_RK+(0.3554628826E-5_RK+0.1309556510E-5_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(1.881509661E-7_RK+(0.2337485010E-4_RK+ &
              (0.3685423725E-4_RK+(0.1724069303E-4_RK+(-2.336925266E-9_RK+ &
              (-0.1329720754E-5_RK+4.583665119E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.2160466882E-5_RK+ &
              (-0.5916296650E-5_RK+(-0.4571662219E-5_RK+(-3.164088595E-7_RK+ &
              (8.627845188E-7_RK+(1.584888101E-7_RK-6.228755374E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.6_RK .AND. TT2>=0.15_RK) THEN
            Y1 = 20.0_RK*TT - 13.0_RK
            Y2 = 5.714285714285714_RK*TT2 - 1.857142857142857_RK

            V(I) = 0.1371109243_RK + (0.9225678930E-1_RK+(0.7535913003E-2_RK+(-0.2487626332E-2_RK+ &
              (-0.6781089442E-3_RK+(0.2845929874E-4_RK+0.2516526645E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.3322160557E-2_RK+(0.6660178729E-2_RK+(0.4999243268E-2_RK+ &
              (0.1593829824E-2_RK+(0.8503570474E-4_RK+(-0.6416584727E-4_RK-0.8156838239E-5_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.5474530098E-3_RK+(-0.1007995733E-2_RK+ &
              (-0.6154386038E-3_RK+(-0.7114810858E-4_RK+(0.6765720797E-4_RK+ &
              (0.2065568057E-4_RK-0.1419378643E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.4996709579E-4_RK+ &
              (0.7021385422E-4_RK+(0.7410388137E-5_RK+(-0.3502103812E-4_RK+ &
              (-0.2083091467E-4_RK+(-0.1905963595E-5_RK+0.1209917072E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (-0.2901371152E-5_RK+(-4.641214414E-7_RK+(0.7096296799E-5_RK+ &
              (0.7491138128E-5_RK+(0.2252038859E-5_RK+(-4.495486430E-7_RK- &
              3.094252165E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(3.688392893E-8_RK+(-5.913625737E-7_RK+ &
              (-0.1213807857E-5_RK+(-7.028385766E-7_RK+(5.793152364E-8_RK+ &
              (1.738698716E-7_RK+3.796203605E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(1.550769764E-8_RK+ &
              (8.981930709E-8_RK+(1.092042353E-7_RK+(9.226024624E-9_RK+ &
              (-5.494174861E-8_RK+(-2.609171415E-8_RK+2.412078331E-12_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.5_RK .AND. TT2>=0.5_RK) THEN
            Y1 = 20.0_RK*TT - 11.0_RK
            Y2 = 4.0_RK*TT2 - 3.0_RK

            V(I) = 0.2077063220_RK + (-0.4181832062E-1_RK+(-0.5940048872E-1_RK+(0.1905105778E-2_RK+ &
              (0.3061012128E-2_RK+(-0.4931703596E-3_RK-0.6407844824E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.7112984395E-1_RK+(0.4483681835E-1_RK+(-0.9618930750E-2_RK+ &
              (-0.8784685780E-2_RK+(0.5916980010E-3_RK+(0.4892711430E-3_RK-0.1073448270E-3_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.3677425858E-2_RK+(0.1347631822E-1_RK+ &
              (0.8593586413E-2_RK+(-0.4187595063E-4_RK+(-0.9311944736E-3_RK+ &
              (0.3481913486E-4_RK+0.5738148646E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1501436513E-2_RK+ &
              (-0.1404334000E-2_RK+(0.7413496508E-3_RK+(0.9428026193E-3_RK+ &
              (0.8695804620E-4_RK+(-0.7559898907E-4_RK+7.871735865E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (-0.4790377208E-4_RK+(-0.4160241540E-3_RK+(-0.4698783407E-3_RK+ &
              (-0.9753441549E-4_RK+(0.6249286212E-4_RK+(0.1315876356E-4_RK- &
              0.5935500667E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.3749703127E-4_RK+(0.6903730648E-4_RK+ &
              (0.8539742703E-5_RK+(-0.3776027060E-4_RK+(-0.1558853463E-4_RK+ &
              (0.2532599595E-5_RK+0.1272061096E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1924865558E-5_RK+ &
              (0.5247391816E-5_RK+(0.1511521180E-4_RK+(0.9043095263E-5_RK+ &
              (-4.489205720E-7_RK+(-0.1183910310E-5_RK+5.206746840E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.5_RK .AND. TT2>=0.15_RK) THEN
            Y1 = 20.0_RK*TT - 11.0_RK
            Y2 = 5.714285714285714_RK*TT2 - 1.857142857142857_RK

            V(I) = 0.1278306745_RK + (0.7436067684E-1_RK+(-0.4824055269E-2_RK+(-0.5537731613E-2_RK+ &
              (-0.3811632974E-3_RK+(0.2401472201E-3_RK+0.2008656120E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.6203442981E-2_RK+(0.1148220364E-1_RK+(0.7204129232E-2_RK+ &
              (0.1164529944E-2_RK+(-0.4886443214E-3_RK+(-0.1360440862E-3_RK+0.2442160088E-4_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.9144597949E-3_RK+(-0.1366744050E-2_RK+ &
              (-0.3654433008E-3_RK+(0.3698896440E-3_RK+(0.2222836119E-3_RK+ &
              (7.087216407E-7_RK-0.1813024557E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.7059249226E-4_RK+ &
              (0.3145745321E-4_RK+(-0.1158100127E-3_RK+(-0.1172772520E-3_RK+ &
              (-0.2150639792E-4_RK+(0.1306232330E-4_RK+0.4183057613E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
              (-0.1430651302E-5_RK+(0.1324808892E-4_RK+(0.2564322656E-4_RK+ &
              (0.1061467201E-4_RK+(-0.5127081081E-5_RK+(-0.3718409827E-5_RK- &
              4.870542935E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-4.810117134E-7_RK+(-0.2431456378E-5_RK+ &
              (-0.2171622108E-5_RK+(0.1002333493E-5_RK+(0.1894042795E-5_RK+ &
              (3.335560728E-7_RK-2.289200273E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(8.248606966E-8_RK+ &
              (2.077190090E-7_RK+(-5.273497385E-8_RK+(-4.087530776E-7_RK+ &
              (-2.542421335E-7_RK+(4.820914109E-8_RK+6.221851471E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.4_RK .AND. TT2>=0.5_RK) THEN
            Y1 = 20.0_RK*TT - 9.0_RK
            Y2 = 4.0_RK*TT2 - 3.0_RK

            V(I) = 0.9014993092E-1_RK + (-0.7467086968E-1_RK+(-0.1841935068E-1_RK+( &
              0.1189253390E-1_RK+(-0.1160630380E-2_RK+(-0.6325923367E-3_RK+(0.2667272378E-3_RK+( &
              -0.2485165137E-4_RK-0.9642542235E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + &
              (0.4300889936E-1_RK+(-0.8933358620E-2_RK+(-0.2273056487E-1_RK+ &
              (0.1467272402E-2_RK+(0.2509033528E-2_RK+(-0.6673276614E-3_RK+ &
              (-0.5382477476E-4_RK+(0.7042866329E-4_RK-0.1505356524E-4_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.8588399378E-2_RK+(0.9035460273E-2_RK+ &
              (-0.3534337450E-2_RK+(-0.3515843402E-2_RK+(0.6504857415E-3_RK+ &
              (0.3265291842E-3_RK+(-0.1397184213E-3_RK+(-0.1418395551E-5_RK+0.1124243781E-4_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.2053838175E-3_RK+(0.2632781762E-2_RK+( &
              0.1982738288E-2_RK+(-0.5332675577E-3_RK+(-0.4722662647E-3_RK+(0.1153461274E-3_RK+( &
              0.3462241013E-4_RK+(-0.1791009435E-4_RK+0.1281011726E-5_RK*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y2)*Y2)*Y2+(-0.2717220119E-3_RK+(-0.1973245556E-3_RK+(0.4459451798E-3_RK+( &
              0.3610167788E-3_RK+(-0.5749582059E-4_RK+(-0.5917535148E-4_RK+ &
              (0.1618063008E-4_RK+(0.4001613274E-5_RK-0.2349602048E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.2304023549E-4_RK+(-0.1383909509E-3_RK+ &
              (-0.1198253871E-3_RK+(0.3591672012E-4_RK+(0.5075282958E-4_RK+ &
              (-0.4715671709E-5_RK+(-0.6915352518E-5_RK+(0.1371689108E-5_RK+4.015093162E-7_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.9911455266E-5_RK+(0.9339286128E-5_RK+( &
              -0.2300270291E-4_RK+(-0.2745369414E-4_RK+(-5.290982113E-7_RK+(0.5969390819E-5_RK+( &
              -3.072472872E-7_RK+(-6.830736307E-7_RK+1.544611940E-7_RK*Y2)* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(6.379610202E-7_RK+(0.5433180892E-5_RK+(0.6784892894E-5_RK+ &
              (-3.006874943E-7_RK+(-0.3285768817E-5_RK+(-4.026111444E-7_RK+ &
              (5.846105670E-7_RK+(5.315392359E-9_RK-6.437644511E-8_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-3.733660825E-7_RK+(-6.767010130E-7_RK+ &
              (5.595306143E-7_RK+(0.1447379074E-5_RK+(4.238329031E-7_RK+ &
              (-3.101504958E-7_RK+(-8.034228742E-8_RK+(4.438589402E-8_RK+2.586695531E-9_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

          ELSE IF (TT>=0.4_RK .AND. TT2>=0.15_RK) THEN
            Y1 = 20.0_RK*TT - 9.0_RK
            Y2 = 5.714285714285714_RK*TT2 - 1.857142857142857_RK

            V(I) = 0.1111995092_RK + (0.4598206430E-1_RK+(-0.1929428976E-1_RK+(-0.5355711490E-2_RK+ &
              (0.1494670216E-2_RK+(0.3727768424E-3_RK+(-0.1208069715E-3_RK-0.1550416419E-4_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + (0.1069745806E-1_RK+(0.1667253931E-1_RK+( &
              0.6310515615E-2_RK+(-0.1904256013E-2_RK+(-0.1271320745E-2_RK+(0.1850450834E-3_RK+( &
              0.1141840798E-3_RK-0.2263764172E-4_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1309910313E-2_RK+ &
              (-0.9992878030E-3_RK+(0.1070775108E-2_RK+(0.1137399628E-2_RK+(0.2348653376E-4_RK+( &
              -0.2047591206E-3_RK+(-0.8285831535E-5_RK+0.2196838692E-4_RK*Y2)*Y2)* &
              Y2)*Y2)*Y2)*Y2)*Y2+(0.4580566600E-4_RK+(-0.1998123515E-3_RK+(-0.3647653319E-3_RK+( &
              -0.7305391247E-4_RK+(0.1252185143E-3_RK+(0.4310852015E-4_RK+(-0.1611306775E-4_RK- &
              0.5608915332E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.1031677459E-4_RK+(0.4652690318E-4_RK+ &
              (0.2387007047E-4_RK+(-0.3888073705E-4_RK+(-0.3102134465E-4_RK+(0.5440416357E-5_RK+( &
              0.6321085967E-5_RK-5.612020936E-7_RK*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y2)*Y2+(-0.2050496816E-5_RK+(-0.3196678832E-5_RK+ &
              (0.5771237256E-5_RK+(0.1026325906E-4_RK+(7.347826541E-7_RK+ &
              (-0.4335427780E-5_RK+(-7.037859626E-7_RK+7.091906799E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
              Y2)*Y2+(1.483504855E-7_RK+(-3.855588233E-7_RK+(-0.1567081193E-5_RK+(-6.466618282E-7_RK &
              +(0.1159878212E-5_RK+(7.790521677E-7_RK+(-2.002689827E-7_RK-1.788244715E-7_RK* &
              Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(6.726991095E-9_RK+(1.168631641E-7_RK+(1.354529514E-7_RK+( &
              -1.682809485E-7_RK+(-2.604535401E-7_RK+(2.307761731E-10_RK+ &
              (8.044980155E-8_RK+1.154706519E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)* &
              Y1)*Y1

          ELSE IF (TT>=2.0E-01_RK) THEN
            Y1 = 10.0_RK*TT - 3.0_RK

            IF (TT2>=0.99_RK) THEN

              DW = 121.8580370326399E-3_RK + (61.8584050241233E-3_RK+(12.00745841701653E-3_RK+( &
                3.124234209120736E-3_RK+(1.082353493987851E-3_RK+(499.7206337472476E-6_RK+( &
                267.7119257237525E-6_RK+(100.3559153970767E-6_RK+(-45.10008959276211E-6_RK+( &
                -93.95793948714774E-6_RK+(-35.10236351446442E-6_RK+(16.07362232763217E-6_RK+( &
                10.70120322E-6_RK)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

              D_1 = (ONE-TWO*ABS_X*DW)

              V(I) = EXP(Y_SQR-X_SQR)*(COS(TWO*ABS_X*Y)) - TWO_SQRT_PI_Y*(D_1-Y_SQR*( &
                -(0.666666666666666667_RK)*(ABS_X*(-(ABS_X*D_1+DW))+D_1)))

            ELSE IF (TT2>=0.95_RK) THEN
              Y2 = 50.0_RK*TT2 - 48.50_RK

              V(I) = 0.1942456438E-2_RK + (-0.1334406810E-2_RK+(0.2689252531E-4_RK+( &
                -3.998960064E-7_RK+(2.270127063E-9_RK+1.119399185E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
                (0.2048761380E-2_RK+(-0.1406462192E-2_RK+(0.2754030723E-4_RK+ &
                (-2.081224096E-7_RK+(-9.292185005E-9_RK+5.100910841E-10_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.1013944784E-2_RK+(-0.6934096673E-3_RK+ &
                (0.1242350331E-4_RK+(1.833246878E-7_RK+(-1.925638632E-8_RK+6.536744373E-10_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.4252985100E-3_RK+(-0.2821247952E-3_RK+(0.3661940256E-5_RK+( &
                3.417135216E-7_RK+(-1.884227647E-8_RK+3.929714149E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (0.2356407585E-3_RK+(-0.1323716412E-3_RK+(-1.349548497E-7_RK+ &
                (3.623412782E-7_RK+(-1.218894174E-8_RK-3.983352526E-11_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.1999089847E-3_RK+(-0.7025928118E-4_RK+ &
                (-0.2522020843E-5_RK+(3.072169301E-7_RK+(-2.190974149E-9_RK- &
                3.968304850E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2+(0.2125323621E-3_RK+ &
                (-0.3082482746E-4_RK+(-0.3963573722E-5_RK+(1.520065756E-7_RK+ &
                (7.405788767E-9_RK-4.196419356E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (0.2045615820E-3_RK+(0.3245777867E-5_RK+(-0.3593337941E-5_RK+ &
                (-6.383944615E-8_RK+(9.971553754E-9_RK-5.755960915E-11_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.1254277372E-3_RK+(0.2392295488E-4_RK+ &
                (-0.1072386321E-5_RK+(-1.728716757E-7_RK+(2.911428281E-9_RK+2.762844062E-10_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.1787353537E-5_RK+(0.1956157081E-4_RK+(0.1553902031E-5_RK+( &
                -7.643099234E-8_RK+(-5.153481960E-9_RK+1.763406838E-10_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2+(-0.5763553363E-4_RK+(7.142234709E-7_RK+(0.1507394705E-5_RK+ &
                (5.436340831E-8_RK+(-4.163042413E-9_RK-8.585734161E-11_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(-0.2402563522E-4_RK+(-0.8062120358E-5_RK+ &
                (-1.963871363E-7_RK+(4.836370671E-8_RK+(1.319800711E-9_RK-9.286614295E-11_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.9766040496E-5_RK+(-0.3042684609E-5_RK+(-5.955124544E-7_RK+( &
                -5.671292682E-9_RK+(1.919540464E-9_RK+1.185198015E-11_RK*Y2) &
                *Y2)*Y2)*Y2)*Y2+(0.5631225221E-5_RK+(0.1287326943E-5_RK+(-1.029166292E-8_RK+ &
                (-1.006094809E-8_RK+(-1.516442065E-10_RK+1.909329688E-11_RK*Y2)*Y2) &
                *Y2)*Y2)*Y2+(-5.066706266E-7_RK+(7.469681320E-7_RK+ &
                (1.013328832E-7_RK+(-5.693988577E-10_RK+(-3.713953030E-10_RK+9.790386087E-14_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            ELSE IF (TT2>=0.9_RK) THEN
              Y2 = 40.0_RK*TT2 - 37.0_RK

              V(I) = 0.5085621196E-2_RK + (-0.1826979957E-2_RK+(0.4632186648E-4_RK+( &
                -8.072874623E-7_RK+(1.247068109E-9_RK+6.300217469E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2 + &
                (0.5354827131E-2_RK+(-0.1916326192E-2_RK+(0.4468655762E-4_RK+ &
                (-1.859582319E-7_RK+(-3.982374554E-8_RK+2.277599506E-9_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.2634410356E-2_RK+(-0.9319633718E-3_RK+ &
                (0.1643960169E-4_RK+(7.662374663E-7_RK+(-6.723745985E-8_RK+2.491625397E-9_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.1074181715E-2_RK+(-0.3656432934E-3_RK+(0.1155611199E-5_RK+( &
                0.1036164240E-5_RK+(-5.594790801E-8_RK+9.568469411E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (0.5280329751E-3_RK+(-0.1570658116E-3_RK+(-0.4565635527E-5_RK+ &
                (9.120001176E-7_RK+(-2.551330457E-8_RK-9.136287605E-10_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.3419963883E-3_RK+(-0.6766184834E-4_RK+ &
                (-0.7208457460E-5_RK+(5.910352365E-7_RK+(8.506160513E-9_RK- &
                1.866271724E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2+(0.2622482258E-3_RK+ &
                (-0.1429858232E-4_RK+(-0.7544355072E-5_RK+(1.188420604E-7_RK+ &
                (3.060035243E-8_RK-1.207574851E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (0.1790273154E-3_RK+(0.2218645578E-4_RK+(-0.4455745573E-5_RK+ &
                (-2.948201342E-7_RK+(2.353794730E-8_RK+3.957208093E-10_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.6266298855E-4_RK+(0.3381854500E-4_RK+ &
                (7.258208204E-7_RK+(-3.406425192E-7_RK+(-4.840983389E-9_RK+1.106565817E-9_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2+(-0.3194051786E-4_RK+(0.1507440958E-4_RK+(0.2946573727E-5_RK+( &
                -5.227659593E-8_RK+(-1.664687921E-8_RK+3.206471511E-10_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2+(-0.4423051392E-4_RK+(-0.8181976637E-5_RK+(8.857053168E-7_RK+ &
                (1.428754057E-7_RK+(-2.539917953E-9_RK-4.376761910E-10_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2+(-0.8732579976E-5_RK+(-0.8537400374E-5_RK+ &
                (-7.273587749E-7_RK+(6.960862386E-8_RK+(5.729697332E-9_RK-2.481925200E-10_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.7829738394E-5_RK+(6.571871082E-7_RK+(-2.653658388E-7_RK+( &
                -2.422677907E-8_RK+(9.674356481E-10_RK+7.756760562E-11_RK*Y2) &
                *Y2)*Y2)*Y2)*Y2+(0.3201876918E-5_RK+(0.1608003724E-5_RK+(7.619406166E-8_RK+ &
                (-1.730249644E-8_RK+(-9.277834122E-10_RK+5.913809804E-11_RK*Y2)*Y2) &
                *Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            ELSE IF (TT2>=0.85_RK) THEN
              Y2 = 40.0_RK*TT2 - 35.0_RK

              V(I) = 0.8931325422E-2_RK + (-0.2021939145E-2_RK+(0.5113769565E-4_RK+( &
                -7.865760275E-7_RK+(-7.311379019E-9_RK+(1.132059319E-9_RK+(-5.241285692E-11_RK+ &
                1.677833301E-12_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + (0.9367065638E-2_RK+( &
                -0.2095855801E-2_RK+(0.4464159023E-4_RK+(2.358790706E-7_RK+(-6.750027589E-8_RK+( &
                3.338880834E-9_RK+(-1.005806446E-10_RK+1.644201713E-12_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.4556861204E-2_RK+(-0.9861552955E-3_RK+ &
                (0.1002010290E-4_RK+(0.1409471771E-5_RK+(-9.440726100E-8_RK+ &
                (2.910026476E-9_RK+(-2.065406875E-11_RK-2.755644475E-12_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.1799567319E-2_RK+(-0.3555559315E-3_RK+(-0.6346712166E-5_RK+( &
                0.1515310689E-5_RK+(-6.290144535E-8_RK+(1.313606188E-10_RK+(1.055637358E-10_RK- &
                5.685649133E-12_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.8150561527E-3_RK+( &
                -0.1274298184E-3_RK+(-0.1053669771E-4_RK+(0.1070502185E-5_RK+(-1.027170567E-8_RK+( &
                -2.267824150E-9_RK+(1.309680779E-10_RK-2.461496325E-12_RK*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.4512295429E-3_RK+(-0.3467137755E-4_RK+ &
                (-0.1110525300E-4_RK+(4.343884238E-7_RK+(3.508757201E-8_RK+ &
                (-2.487819949E-9_RK+(2.412470285E-11_RK+3.466353548E-12_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2+(0.2669825762E-3_RK+(0.1792004632E-4_RK+(-0.7553401006E-5_RK+( &
                -2.028681307E-7_RK+(4.039043164E-8_RK+(-5.024804288E-10_RK+(-7.832485446E-11_RK+ &
                4.149294135E-12_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.1032280174E-3_RK+( &
                0.4229704991E-4_RK+(-4.215709563E-7_RK+(-4.501524626E-7_RK+(3.791607537E-9_RK+( &
                1.293944635E-9_RK+(-4.790510747E-11_RK-6.873110941E-13_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1497965183E-4_RK+(0.2321279948E-4_RK+ &
                (0.2844388513E-5_RK+(-1.782149633E-7_RK+(-1.643153855E-8_RK+ &
                (8.460526557E-10_RK+(1.836556106E-11_RK-2.343417148E-12_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2+(-0.3448432841E-4_RK+(-0.5076929476E-5_RK+(8.586095485E-7_RK+( &
                9.355459878E-8_RK+(-3.787138289E-9_RK+(-2.466060053E-10_RK+(1.504762853E-11_RK- &
                2.080666427E-14_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.9933532202E-5_RK+( &
                -0.6104982948E-5_RK+(-2.792422365E-7_RK+(6.582777641E-8_RK+(2.545125620E-9_RK+( &
                -2.513531689E-10_RK+(-1.008307456E-12_RK+5.528705893E-13_RK*Y2) &
                *Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            ELSE IF (TT2>=0.75_RK) THEN
              Y2 = 20.0_RK*TT2 - 16.0_RK

              V(I) = 0.1547771027E-1_RK + (-0.4697338363E-2_RK+(0.2297737124E-3_RK+( &
                -0.4507025353E-5_RK+(-5.308377459E-7_RK+(7.855652830E-8_RK+(-6.321818337E-9_RK+ &
                3.508093112E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + (0.1604368298E-1_RK+( &
                -0.4697079494E-2_RK+(0.1513686286E-3_RK+(0.1123937432E-4_RK+(-0.2120215437E-5_RK+( &
                1.726743555E-7_RK+(-7.709821208E-9_RK-3.189493029E-11_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.7559090111E-2_RK+(-0.1993664808E-2_RK+ &
                (-0.3422539814E-4_RK+(0.2244084253E-4_RK+(-0.2194278239E-5_RK+ &
                (7.825224814E-8_RK+(6.238282429E-9_RK-1.164275909E-9_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.2763164519E-2_RK+(-0.5398015159E-3_RK+(-0.9302716213E-4_RK+( &
                0.1765632051E-4_RK+(-7.117966862E-7_RK+(-9.751011415E-8_RK+(1.651667851E-8_RK- &
                1.065979834E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.1073431148E-2_RK+( &
                -0.7063418511E-4_RK+(-0.7977584281E-4_RK+(0.7307753282E-5_RK+(6.889826735E-7_RK+( &
                -1.561226652E-7_RK+(8.779211329E-9_RK+3.890501773E-10_RK*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.4470234574E-3_RK+(0.7775446238E-4_RK+ &
                (-0.4976215739E-4_RK+(-0.1688507093E-5_RK+(0.1139370053E-5_RK+ &
                (-6.202239863E-8_RK+(-6.896761612E-9_RK+1.169306451E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2+(0.1540466613E-3_RK+(0.1066662695E-3_RK+(-0.1411053760E-4_RK+( &
                -0.5427575639E-5_RK+(5.335176920E-7_RK+(5.440226335E-8_RK+(-1.027815480E-8_RK+ &
                3.477095640E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1534326402E-4_RK+( &
                0.6570296453E-4_RK+(0.1373075554E-4_RK+(-0.2854668908E-5_RK+(-3.320245988E-7_RK+( &
                5.861325962E-8_RK+(1.824549985E-10_RK-5.591759664E-10_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.5572450690E-4_RK+(0.6824843540E-5_RK+ &
                (0.1347110338E-4_RK+(6.234318378E-7_RK+(-3.867849218E-7_RK+ &
                (2.941931393E-10_RK+(4.856538970E-9_RK-3.423000290E-10_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2+(-0.1428799187E-4_RK+(-0.1483020793E-4_RK+(-4.137529693E-7_RK+( &
                8.719429336E-7_RK+(2.877975183E-8_RK+(-1.517071570E-8_RK+(4.135147352E-10_RK+ &
                1.179386075E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.4356086949E-5_RK+( &
                -0.6048617828E-5_RK+(-0.2682962400E-5_RK+(1.198732725E-7_RK+(8.911474152E-8_RK+( &
                -3.394233030E-9_RK+(-1.023595852E-9_RK+9.873726286E-11_RK*Y2) &
                *Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            ELSE IF (TT2>=0.65_RK) THEN
              Y2 = 20.0_RK*TT2 - 14.0_RK

              V(I) = 0.2581607971E-1_RK + (-0.5645867792E-2_RK+(0.2360237581E-3_RK+( &
                0.4105550848E-5_RK+(-0.1804159483E-5_RK+(1.879193447E-7_RK+(-1.209234665E-8_RK+ &
                4.107587384E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + (0.2591347058E-1_RK+( &
                -0.5084589980E-2_RK+(0.1747633608E-4_RK+(0.3624087229E-4_RK+(-0.4241357236E-5_RK+( &
                2.349659291E-7_RK+(1.361488521E-9_RK-1.620546942E-9_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.1119294184E-1_RK+(-0.1512783710E-2_RK+ &
                (-0.2253774266E-3_RK+(0.4132272906E-4_RK+(-0.2172108693E-5_RK+ &
                (-1.395947115E-7_RK+(3.475588746E-8_RK-2.934173000E-9_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.3322332373E-2_RK+(0.5551707139E-4_RK+(-0.2035828418E-3_RK+( &
                0.1623368793E-4_RK+(0.1531714500E-5_RK+(-3.720948160E-7_RK+(2.545641957E-8_RK+ &
                4.841295199E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.8536476813E-3_RK+( &
                0.3001988864E-3_RK+(-0.9292346460E-4_RK+(-0.5440379130E-5_RK+(0.2531000274E-5_RK+( &
                -1.672562091E-7_RK+(-1.454101760E-8_RK+3.306351126E-9_RK*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.1255895463E-3_RK+(0.2170035584E-3_RK+ &
                (-0.9834789017E-5_RK+(-0.1145285149E-4_RK+(9.724195463E-7_RK+ &
                (1.356191349E-7_RK+(-2.582631782E-8_RK+9.931567524E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2+(-0.6620388102E-4_RK+(0.8733671734E-4_RK+(0.2430842463E-4_RK+( &
                -0.5798266148E-5_RK+(-6.396643450E-7_RK+(1.672435156E-7_RK+(-2.785715402E-9_RK- &
                1.869971023E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.7608678428E-4_RK+( &
                -0.8479000496E-5_RK+(0.1868177532E-4_RK+(0.1737268398E-5_RK+(-7.068997953E-7_RK+( &
                -8.067787045E-9_RK+(1.188302368E-8_RK-8.740488003E-10_RK*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.2632409694E-4_RK+(-0.2824652816E-4_RK+ &
                (0.1784093597E-5_RK+(0.2803176050E-5_RK+(-3.409755758E-8_RK+ &
                (-7.124033115E-8_RK+(4.467793544E-9_RK+6.670701029E-10_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2+(0.7697232385E-5_RK+(-0.4864087090E-5_RK+(-0.3738692761E-5_RK+( &
                5.411133062E-8_RK+(1.593752948E-7_RK+(-4.932868000E-9_RK+(-2.486411330E-9_RK+ &
                2.461904721E-10_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.6219379542E-5_RK+( &
                0.3236357597E-5_RK+(-0.1297680825E-5_RK+(-5.173988739E-7_RK+(3.989600718E-8_RK+( &
                1.415741763E-8_RK+(-1.331736713E-9_RK-1.235624252E-10_RK*Y2) &
                *Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            ELSE IF (TT2>=0.55_RK) THEN
              Y2 = 20.0_RK*TT2 - 12.0_RK

              V(I) = 0.3798336049E-1_RK + (-0.6465435146E-2_RK+(0.1499155751E-3_RK+( &
                0.2818014486E-4_RK+(-0.4493546547E-5_RK+(3.508526473E-7_RK-1.240357820E-8_RK*Y2)*Y2) &
                *Y2)*Y2)*Y2)*Y2 + (0.3578758469E-1_RK+(-0.4566203560E-2_RK+(-0.3188702373E-3_RK+ &
                (0.7813415879E-4_RK+(-0.5836923756E-5_RK+(-2.471355073E-8_RK+5.152493022E-8_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.1295885562E-1_RK+(-0.6532510788E-4_RK+ &
                (-0.5040277109E-3_RK+(0.4585318556E-4_RK+(0.2183574637E-5_RK+ &
                (-8.136523801E-7_RK+7.216868276E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.2304871134E-2_RK+ &
                (0.9813303840E-3_RK+(-0.2290569777E-3_RK+(-0.1416574612E-4_RK+ &
                (0.6273437771E-5_RK+(-4.549396138E-7_RK-3.112986015E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (-0.3137921390E-4_RK+(0.5184762540E-3_RK+(0.8985719927E-5_RK+ &
                (-0.2803539029E-4_RK+(0.2112212302E-5_RK+(3.726313763E-7_RK- &
                7.241265815E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.2460921984E-3_RK+(0.1042294031E-3_RK+ &
                (0.6457061248E-4_RK+(-0.9574594521E-5_RK+(-0.1940604052E-5_RK+ &
                (4.016383806E-7_RK-1.903895208E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1101670753E-3_RK+ &
                (-0.5110301587E-4_RK+(0.2807717021E-4_RK+(0.5472655128E-5_RK+ &
                (-0.1481655073E-5_RK+(-6.350441016E-8_RK+3.510522462E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (-0.9247799403E-5_RK+(-0.4344314429E-4_RK+(-0.4427593954E-5_RK+ &
                (0.4958789461E-5_RK+(2.084888667E-7_RK+(-1.744662344E-7_RK+7.573440510E-9_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.1383931944E-4_RK+(-0.1148944082E-5_RK+ &
                (-0.6087663843E-5_RK+(-3.700534365E-7_RK+(3.452291386E-7_RK+ &
                (2.199326176E-10_RK-7.909555561E-9_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.4891348552E-5_RK+( &
                0.6018910451E-5_RK+(-7.210590348E-7_RK+(-9.719970389E-7_RK+ &
                (1.954279965E-8_RK+(3.677259855E-8_RK-2.491257236E-9_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            ELSE IF (TT2>=0.35_RK) THEN
              Y2 = 10.0_RK*TT2 - 4.5_RK

              V(I) = 0.5751228067E-1_RK + (-0.1193059630E-1_RK+(-0.1793487238E-2_RK+( &
                0.9219595127E-3_RK+(-0.1489738080E-3_RK+(1.584002294E-7_RK+(0.5518570640E-5_RK+( &
                -0.1287678995E-5_RK+1.061097022E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + &
                (0.4408982308E-1_RK+(-0.5740231753E-4_RK+(-0.4941348737E-2_RK+ &
                (0.7919922812E-3_RK+(0.1292219613E-3_RK+(-0.7222388198E-4_RK+ &
                (0.1058299692E-4_RK+(0.1081390392E-5_RK-6.743552630E-7_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.7804829003E-2_RK+(0.7071118301E-2_RK+ &
                (-0.2016804205E-2_RK+(-0.6607453084E-3_RK+(0.3076778775E-3_RK+ &
                (-0.1702527553E-4_RK+(-0.1607798285E-4_RK+(0.4493748982E-5_RK- &
                2.220755283E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1742569289E-2_RK+ &
                (0.2410806993E-2_RK+(0.1074097560E-2_RK+(-0.6507574284E-3_RK+ &
                (-0.3486042774E-4_RK+(0.7275936653E-4_RK+(-0.1348291790E-4_RK+ &
                (-0.2334540003E-5_RK+0.1282636092E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (-0.7228541445E-3_RK+(-0.5249892464E-3_RK+(0.7551314822E-3_RK+ &
                (0.1238164941E-3_RK+(-0.1663451223E-3_RK+(0.1461264447E-4_RK+ &
                (0.1406203678E-4_RK+(-0.3884534081E-5_RK-9.667333125E-8_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2)*Y2+(0.4107465109E-4_RK+(-0.3958147249E-3_RK+ &
                (-0.1019742566E-3_RK+(0.2047003806E-3_RK+(8.268402777E-7_RK+ &
                (-0.3362560586E-4_RK+(0.6794116827E-5_RK+(0.1877177418E-5_RK-8.957086490E-7_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.7158105031E-4_RK+ &
                (0.1389568855E-4_RK+(-0.1571010238E-3_RK+(-0.1098027575E-4_RK+ &
                (0.5420374111E-4_RK+(-0.5384079781E-5_RK+(-0.6967294570E-5_RK+ &
                (0.1686651121E-5_RK+2.373609959E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+( &
                0.3118326178E-5_RK+(0.4417420393E-4_RK+(0.3865332789E-5_RK+ &
                (-0.3443549535E-4_RK+(8.478475627E-7_RK+(0.7465001874E-5_RK+ &
                (-0.1508982541E-5_RK+(-5.743071560E-7_RK+2.470921557E-7_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.6246564143E-5_RK+(0.2550270453E-5_RK+ &
                (0.2153846604E-4_RK+(7.144743854E-8_RK+(-0.9997108344E-5_RK+ &
                (9.454331353E-7_RK+(0.1676041830E-5_RK+(-3.460435184E-7_RK-9.385923287E-8_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            ELSE IF (TT2>=0.15_RK) THEN
              Y2 = 10.0_RK*TT2 - 2.5_RK

              V(I) = 0.6496898612E-1_RK + (0.9404321640E-2_RK+(-0.8685768572E-2_RK+( &
                0.5408364498E-3_RK+(0.4650671099E-3_RK+(-0.1035212572E-3_RK+(-0.1163245644E-4_RK+( &
                0.7480827937E-5_RK-5.586219016E-7_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2 + &
                (0.2281971172E-1_RK+(0.1858242588E-1_RK+(-0.5009775700E-3_RK+ &
                (-0.2684467823E-2_RK+(0.2306439554E-3_RK+(0.2376781192E-3_RK+ &
                (-0.5548758403E-4_RK+(-0.1075420291E-4_RK+0.5386341697E-5_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.5231948330E-2_RK+(0.8991418286E-3_RK+ &
                (0.4427771471E-2_RK+(0.3239141494E-3_RK+(-0.8417067181E-3_RK+ &
                (0.2459124040E-4_RK+(0.9922766932E-4_RK+(-0.1312499671E-4_RK- &
                0.6313393179E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.1618052933E-3_RK+ &
                (-0.2612447001E-2_RK+(-0.9495589936E-3_RK+(0.1129357781E-2_RK+ &
                (0.2867905744E-3_RK+(-0.2487790020E-3_RK+(-0.1809936473E-4_RK+ &
                (0.3099621767E-4_RK-0.2452265584E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+ &
                (0.4903061269E-3_RK+(0.6652391187E-3_RK+(-0.6319316435E-3_RK+ &
                (-0.5685334156E-3_RK+(0.2416066543E-3_RK+(0.1440138170E-3_RK+ &
                (-0.6475402164E-4_RK+(-0.1526928259E-4_RK+0.9666208870E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)* &
                Y2)*Y2)*Y2+(-0.1474839064E-3_RK+(0.1216708385E-3_RK+ &
                (0.4161738393E-3_RK+(-0.7063466680E-4_RK+(-0.2273641762E-3_RK+ &
                (0.3779752898E-4_RK+(0.5561568635E-4_RK+(-0.1081244330E-4_RK-0.6286822907E-5_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(0.5479296232E-5_RK+ &
                (-0.1256998126E-3_RK+(-0.4894488854E-4_RK+(0.1581377140E-3_RK+ &
                (0.3621966018E-4_RK+(-0.7082913682E-4_RK+(-0.4448357256E-5_RK+ &
                (0.1389356564E-4_RK-0.1064436906E-5_RK*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2+( &
                0.1155505293E-4_RK+(0.2054063015E-4_RK+(-0.5014283762E-4_RK+ &
                (-0.3145712800E-4_RK+(0.4299135832E-4_RK+(0.1136830104E-4_RK+ &
                (-0.1705073637E-4_RK+(-9.040012833E-7_RK+0.3042929666E-5_RK*Y2)*Y2)* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2+(-0.3586681384E-5_RK+(0.5937397198E-5_RK+ &
                (0.2103508750E-4_RK+(-0.1165319248E-4_RK+(-0.2050649198E-4_RK+ &
                (0.8533172224E-5_RK+(0.7450548634E-5_RK+(-0.2512747416E-5_RK-0.1044579440E-5_RK* &
                Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y2)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1)*Y1

            END IF
          END IF
        END IF
      END DO
    END SUBROUTINE



    ! ====================================
    ! ====================================


    ! HUMLICEK ROUTINE, AS USED IN THE MEUDON PDR CODE
    ! %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    SUBROUTINE HUMLIK(N1, N2, X, Y, K)
      ! %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      ! TAKEN FROM R.J. WELLS, JQSRT (1999), 62, 29

      INTEGER, INTENT (IN) :: N1, N2
      REAL (KIND=RK), INTENT (IN) :: X(N1:N2)
      REAL (KIND=RK), INTENT (IN) :: Y
      REAL (KIND=RK), INTENT (OUT) :: K(N1:N2)

      REAL (KIND=RK) R0, R1
      ! PARAMETER (R0 = 146.7, R1 = 14.67)
      ! ERROR LESS THAN 10^{-RR}
      ! RR MUST <= 5.0
      ! PARAMETER (R0 = 1.51 * EXP(1.144*RR), R1 = 1.60 * EXP(0.554*RR))
      ! CONSTRAINT: 14.88 < R0 < 460.4 AND 4.85 < R1 < 25.5
      PARAMETER (R0=460.4_RK, R1=25.5_RK)

      REAL (KIND=RK) RRTPI
      PARAMETER (RRTPI=0.564189583547756_RK)
      REAL (KIND=RK) Y0, Y0PY0, Y0Q
      PARAMETER (Y0=1.5_RK, Y0PY0=Y0+Y0, Y0Q=Y0*Y0)
      REAL (KIND=RK) C(0:5), S(0:5), T(0:5)
      SAVE C, S, T
      DATA C/1.0117281_RK, -0.75197147_RK, 0.012557727_RK, 0.010022008_RK, -0.00024206814_RK, &
        0.00000050084806_RK/
      DATA S/1.393237_RK, 0.23115241_RK, -0.15535147_RK, 0.0062183662_RK, 0.000091908299_RK, &
        -0.00000062752596_RK/
      DATA T/0.31424038_RK, 0.94778839_RK, 1.5976826_RK, 2.2795071_RK, 3.0206370_RK, 3.8897249_RK/

      INTEGER I, J
      INTEGER RG1, RG2, RG3
      REAL (KIND=RK) ABX, XQ, YQ, YRRTPI
      REAL (KIND=RK) XLIM0, XLIM1, XLIM2, XLIM3, XLIM4
      ! 2 XI 2020 - INITIALIZE AT COMPILATION TIME TO AVOID WARNINGS
      REAL (KIND=RK) :: A0 = 0.0_RK
      REAL (KIND=RK) :: D0 = 0.0_RK
      REAL (KIND=RK) :: D2 = 0.0_RK
      REAL (KIND=RK) :: E0 = 0.0_RK
      REAL (KIND=RK) :: E2 = 0.0_RK
      REAL (KIND=RK) :: E4 = 0.0_RK
      REAL (KIND=RK) :: H0 = 0.0_RK
      REAL (KIND=RK) :: H2 = 0.0_RK
      REAL (KIND=RK) :: H4 = 0.0_RK
      REAL (KIND=RK) :: H6 = 0.0_RK
      REAL (KIND=RK) P0, P2, P4, P6, P8, Z0, Z2, Z4, Z6, Z8
      REAL (KIND=RK) XP(0:5), XM(0:5), YP(0:5), YM(0:5)
      REAL (KIND=RK) MQ(0:5), PQ(0:5), MF(0:5), PF(0:5)
      REAL (KIND=RK) D, YF, YPY0, YPY0Q

      ! -----------------------------------------------------------------------

      RG1 = 1
      RG2 = 1
      RG3 = 1
      YQ = Y*Y
      YRRTPI = Y*RRTPI

      XLIM0 = R0 - Y
      XLIM1 = R1 - Y
      XLIM3 = 3.097_RK*Y - 0.45_RK

      ! XLIM0 = 15100.0 + Y * (40.0 + Y * 3.6)
      ! XLIM1 = 164.0 - Y * (4.3 + Y * 1.8)
      ! XLIM3 = 5.76 * YQ

      XLIM2 = 6.8_RK - Y
      XLIM4 = 18.1_RK*Y + 1.65_RK
      IF (Y<=1.0E-6_RK) THEN
        XLIM1 = XLIM0
        XLIM2 = XLIM0
      END IF

      DO I = N1, N2
        ABX = ABS(X(I))
        XQ = ABX*ABX

        IF (ABX>XLIM0) THEN
          K(I) = YRRTPI/(XQ+YQ)

        ELSE IF (ABX>XLIM1) THEN
          IF (RG1/=0) THEN
            RG1 = 0
            A0 = YQ + 0.5_RK
            D0 = A0*A0
            D2 = YQ + YQ - 1.0_RK
          END IF
          D = RRTPI/(D0+XQ*(D2+XQ))
          K(I) = D*Y*(A0+XQ)

        ELSE IF (ABX>XLIM2) THEN
          IF (RG2/=0) THEN
            RG2 = 0
            H0 = 0.5625_RK + YQ*(4.5_RK+YQ*(10.5_RK+YQ*(6.0_RK+YQ)))
            H2 = -4.5_RK + YQ*(9.0_RK+YQ*(6.0_RK+YQ*4.0_RK))
            H4 = 10.5_RK - YQ*(6.0_RK-YQ*6.0_RK)
            H6 = -6.0_RK + YQ*4.0_RK
            E0 = 1.875_RK + YQ*(8.25_RK+YQ*(5.5_RK+YQ))
            E2 = 5.25_RK + YQ*(1.0_RK+YQ*3.0_RK)
            E4 = 0.75_RK*H6
          END IF
          D = RRTPI/(H0+XQ*(H2+XQ*(H4+XQ*(H6+XQ))))
          K(I) = D*Y*(E0+XQ*(E2+XQ*(E4+XQ)))

        ELSE IF (ABX<XLIM3) THEN
          IF (RG3/=0) THEN
            Z0 = 272.1014_RK + Y*(1280.829_RK+Y*(2802.870_RK+Y*(3764.966_RK+ &
              Y*(3447.629_RK+Y*(2256.981_RK+Y*(1074.409_RK+Y*(369.1989_RK+Y*(88.26741_RK+Y*( &
              13.39880_RK+Y)))))))))
            Z2 = 211.678_RK + Y*(902.3066_RK+Y*(1758.336_RK+Y*(2037.310_RK+ &
              Y*(1549.675_RK+Y*(793.4273_RK+Y*(266.2987_RK+Y*(53.59518_RK+Y*5.0_RK)))))))
            Z4 = 78.86585_RK + Y*(308.1852_RK+Y*(497.3014_RK+Y*(479.2576_RK+ &
              Y*(269.2916_RK+Y*(80.39278_RK+Y*10.0_RK)))))
            Z6 = 22.03523_RK + Y*(55.02933_RK+Y*(92.75679_RK+Y*(53.59518_RK+Y*10.0_RK)))
            Z8 = 1.496460_RK + Y*(13.39880_RK+Y*5.0_RK)
            P0 = 153.5168_RK + Y*(549.3954_RK+Y*(919.4955_RK+Y*(946.8970_RK+ &
              Y*(662.8097_RK+Y*(328.2151_RK+Y*(115.3772_RK+Y*(27.93941_RK+Y*(4.264678_RK+Y* &
              0.3183291_RK))))))))
            P2 = -34.16955_RK + Y*(-1.322256_RK+Y*(124.5975_RK+Y*(189.7730_RK+ &
              Y*(139.4665_RK+Y*(56.81652_RK+Y*(12.79458_RK+Y*1.2733163_RK))))))
            P4 = 2.584042_RK + Y*(10.46332_RK+Y*(24.01655_RK+Y*(29.81482_RK+ &
              Y*(12.79568_RK+Y*1.9099744_RK))))
            P6 = -0.07272979_RK + Y*(0.9377051_RK+Y*(4.266322_RK+Y*1.273316_RK))
            P8 = 0.0005480304_RK + Y*0.3183291_RK
          END IF
          D = 1.7724538_RK/(Z0+XQ*(Z2+XQ*(Z4+XQ*(Z6+XQ*(Z8+XQ)))))
          K(I) = D*(P0+XQ*(P2+XQ*(P4+XQ*(P6+XQ*P8))))

        ELSE
          YPY0 = Y + Y0
          YPY0Q = YPY0*YPY0
          K(I) = 0.0_RK
          DO J = 0, 5
            D = X(I) - T(J)
            MQ(J) = D*D
            MF(J) = 1.0_RK/(MQ(J)+YPY0Q)
            XM(J) = MF(J)*D
            YM(J) = MF(J)*YPY0
            D = X(I) + T(J)
            PQ(J) = D*D
            PF(J) = 1.0_RK/(PQ(J)+YPY0Q)
            XP(J) = PF(J)*D
            YP(J) = PF(J)*YPY0
          END DO

          IF (ABX<XLIM4) THEN
            DO J = 0, 5
              K(I) = K(I) + C(J)*(YM(J)+YP(J)) - S(J)*(XM(J)-XP(J))
            END DO

          ELSE
            YF = Y + Y0PY0
            DO J = 0, 5
              K(I) = K(I) + (C(J)*(MQ(J)*MF(J)-Y0*YM(J))+S(J)*YF*XM(J))/(MQ(J)+Y0Q) + &
                (C(J)*(PQ(J)*PF(J)-Y0*YP(J))-S(J)*YF*XP(J))/(PQ(J)+Y0Q)
            END DO
            K(I) = Y*K(I) + EXP(-XQ)
          END IF
        END IF
      END DO

    END SUBROUTINE


  END MODULE


